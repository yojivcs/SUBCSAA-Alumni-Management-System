<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manage Job Posts</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Lexend', sans-serif;
      background-color: #f8f9fa;
    }
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      width: 250px;
      height: 100%;
      background-color: #5E3792;
      box-shadow: 4px 0px 10px rgba(0, 0, 0, 0.1);
    }

    .sidebar a {
      color: white;
      display: block;
      padding: 16px;
      text-decoration: none;
      transition: background-color 0.3s;
    }

    .sidebar a:hover {
      background-color: #4B2C6F;
      color: white;
    }

    .content {
      margin-left: 250px;
      padding: 20px;
      background: linear-gradient(45deg, #F9F9F9, #F1F1F1);
    }

    .job-form {
      background: white;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      margin-bottom: 32px;
    }

    .form-title {
      color: #1F2937;
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 24px;
    }

    .form-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #E5E7EB;
      border-radius: 8px;
      margin-bottom: 16px;
      font-family: 'Lexend', sans-serif;
      transition: all 0.3s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: #5E3792;
      box-shadow: 0 0 0 3px rgba(94, 55, 146, 0.1);
    }

    .form-label {
      display: block;
      color: #4B5563;
      font-size: 0.95rem;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .submit-btn {
      background-color: #5E3792;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 500;
      transition: all 0.3s ease;
      width: 100%;
      margin-top: 16px;
    }

    .submit-btn:hover {
      background-color: #4B2C6F;
      transform: translateY(-2px);
    }

    .job-card {
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      margin-bottom: 16px;
      transition: all 0.3s ease;
      border: 1px solid rgba(0, 0, 0, 0.05);
    }

    .job-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }

    .job-title {
      color: #1F2937;
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .job-info {
      color: #4B5563;
      font-size: 0.95rem;
      margin: 8px 0;
      line-height: 1.5;
    }

    .delete-btn {
      background-color: #DC2626;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      font-weight: 500;
      transition: all 0.3s ease;
      margin-top: 16px;
    }

    .delete-btn:hover {
      background-color: #B91C1C;
      transform: translateY(-2px);
    }

    .pay-badge {
      display: inline-flex;
      align-items: center;
      padding: 6px 16px;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 500;
      background-color: #10B981;
      color: white;
      height: 32px;
    }

    .deadline-badge {
      display: inline-flex;
      align-items: center;
      padding: 6px 16px;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 500;
      background-color: #6366F1;
      color: white;
      height: 32px;
    }

    .badges-container {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 16px;
    }
  </style>
</head>
<body class="bg-gray-100">
  <!-- Sidebar Container -->
  <div id="sidebar-container"></div>
  <div class="flex flex-row">
    <!-- Sidebar space -->
    <div class="w-64"></div>
    <div class="container mx-auto mt-10 ml-12">
      <h1 class="text-3xl font-bold mb-8 text-gray-800">Manage Job Posts</h1>

      <!-- Add Job Post Form -->
      <form id="add-job-form" class="job-form">
        <h2 class="form-title">Add New Job Post</h2>
        
        <div class="mb-4">
          <label class="form-label" for="job_title">Job Title</label>
          <input type="text" id="job_title" placeholder="Enter job title" class="form-input">
        </div>

        <div class="mb-4">
          <label class="form-label" for="position">Position Opening</label>
          <input type="text" id="position" placeholder="Enter position" class="form-input">
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="form-label" for="deadline">Application Deadline</label>
            <input type="date" id="deadline" class="form-input">
          </div>
          <div>
            <label class="form-label" for="pay_scale">Pay Scale</label>
            <input type="text" id="pay_scale" placeholder="Enter pay scale" class="form-input">
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="form-label" for="reference">Reference (SUBCSAA Alumni)</label>
            <input type="text" id="reference" placeholder="Enter reference name" class="form-input">
          </div>
          <div>
            <label class="form-label" for="phone">Phone Number</label>
            <input type="text" id="phone" placeholder="Enter contact number" class="form-input">
          </div>
        </div>

        <div class="mb-4">
          <label class="form-label" for="description">Job Description</label>
          <textarea id="description" placeholder="Enter detailed job description" class="form-input" rows="4"></textarea>
        </div>

        <button type="submit" class="submit-btn">Add Job Post</button>
      </form>

      <!-- Job Posts List -->
      <div id="jobs-container" class="grid grid-cols-1 sm:grid-cols-2 gap-6">
        <!-- Job posts will be dynamically loaded here -->
      </div>
    </div>
  </div>

  <!-- Load Sidebar Script -->
  <script>
    // Load Sidebar
    document.addEventListener('DOMContentLoaded', function () {
      document.getElementById('sidebar-container').innerHTML = `
        <div class="sidebar">
          <h2 class="text-white text-xl font-bold p-4">Admin Dashboard</h2>
          <a href="/private/admin/dashboard.html">Dashboard</a>
          <a href="/private/admin/manage_users.html">Manage Users</a>
          <a href="/private/admin/alumni_directory.html">Alumni Directory</a>
          <a href="/private/admin/manage_events.html">Manage Events</a>
          <a href="/private/admin/manage_jobs.html">Manage Job Posts</a>
          <a href="/private/admin/logout.html">Logout</a>
        </div>
      `;
    });

    // Fetch and Display Job Posts
    function fetchJobs() {
      fetch('/php/get_jobs.php')
        .then(response => response.json())
        .then(jobs => {
          const container = document.getElementById('jobs-container');
          container.innerHTML = '';
          jobs.forEach(job => {
            const jobCard = document.createElement('div');
            jobCard.className = 'job-card';

            jobCard.innerHTML = `
              <h3 class="job-title">${job.job_title}</h3>
              <div class="badges-container">
                <span class="pay-badge">BDT ${job.pay_scale}</span>
                <span class="deadline-badge">Deadline: ${job.deadline}</span>
              </div>
              <p class="job-info"><strong>Position:</strong> ${job.position}</p>
              <p class="job-info"><strong>Reference:</strong> ${job.reference}</p>
              <p class="job-info"><strong>Contact:</strong> ${job.phone}</p>
              <p class="job-info mt-4">${job.description}</p>
              <div class="flex justify-end">
                <button onclick="deleteJob(${job.id})" class="delete-btn">Delete Job</button>
              </div>
            `;
            container.appendChild(jobCard);
          });
        });
    }

    // Add Job Post
    document.getElementById('add-job-form').addEventListener('submit', function (e) {
      e.preventDefault();

      const jobData = {
        job_title: document.getElementById('job_title').value.trim(),
        position: document.getElementById('position').value.trim(),
        deadline: document.getElementById('deadline').value.trim(),
        reference: document.getElementById('reference').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        pay_scale: document.getElementById('pay_scale').value.trim(),
        description: document.getElementById('description').value.trim(),
      };

      if (Object.values(jobData).some(field => !field)) {
        alert('All fields are required!');
        return;
      }

      fetch('/php/add_job.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(jobData),
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            alert('Job post added successfully!');
            // Clear form
            e.target.reset();
            fetchJobs(); // Reload job posts
          } else {
            alert('Error adding job post: ' + data.error);
          }
        });
    });

    // Delete Job Post
    function deleteJob(jobId) {
      if (confirm('Are you sure you want to delete this job post?')) {
        fetch('/php/delete_job.php', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id: jobId }),
        })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              alert('Job post deleted successfully');
              fetchJobs();
            } else {
              alert('Error: ' + data.error);
            }
          });
      }
    }

    // Fetch jobs on page load
    fetchJobs();
  </script>
</body>
</html>
